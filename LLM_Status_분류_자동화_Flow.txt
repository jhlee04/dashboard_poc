
# âœ… ì „ì²´ LLM ìƒíƒœ ë¶„ë¥˜ ìë™í™” Flow (ì‚¬ë‚´ íšŒì˜ë¡ ìš”ì•½ ê¸°ë°˜)

## ğŸ“‚ íŒŒì¼ êµ¬ì¡° ì˜ˆì‹œ
project/
â”œâ”€â”€ data/
â”‚   â””â”€â”€ íšŒì˜ìš”ì•½.csv               # Input ë°ì´í„°: íšŒì˜ì¼, ë¶€ì„œ, íŒ€, ê³¼ì œëª…, ìš”ì•½, ì•¡ì…˜, status
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ ê¸°íšíŒ€.txt
â”‚   â”œâ”€â”€ ê¸°ìˆ ê°œë°œíŒ€.txt
â”‚   â””â”€â”€ ìš´ì˜ì§€ì›íŒ€.txt
â”œâ”€â”€ output/
â”‚   â”œâ”€â”€ statusê²€í† _ê¸°íšíŒ€.xlsx     # ë¶€ì„œë³„ ê²€í† ìš© ê²°ê³¼ë¬¼
â”‚   â”œâ”€â”€ statusê²€í† _ê¸°ìˆ ê°œë°œíŒ€.xlsx
â”‚   â””â”€â”€ statusê²€í† _ìš´ì˜ì§€ì›íŒ€.xlsx
â””â”€â”€ main.py                        # ì•„ë˜ì— ì œê³µëœ ì „ì²´ ì½”ë“œ

---

## ğŸ§  1. í”„ë¡¬í”„íŠ¸ ìƒì„± í•¨ìˆ˜ (ë¶€ì„œë³„ ì˜ˆì‹œ í¬í•¨)

```python
def load_examples(dept):
    try:
        with open(f"./prompts/{dept}.txt", "r", encoding="utf-8") as f:
            return f.read()
    except FileNotFoundError:
        return ""

def make_prompt(dept, summary, action):
    examples = load_examples(dept)
    return f"""ë‹¹ì‹ ì€ íšŒì˜ ìš”ì•½ì„ ë³´ê³  ìƒíƒœë¥¼ ë¶„ë¥˜í•˜ê³ , ì´ìœ ë¥¼ ì„¤ëª…í•˜ëŠ” ìš´ì˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

[ìƒíƒœ ê¸°ì¤€]
- On-track: ê³„íšëŒ€ë¡œ ì§„í–‰ ì¤‘ì´ë©° ì´ìŠˆ ì—†ìŒ
- Risk: ì¼ì • ì§€ì—°, ê¸°ëŠ¥ ëˆ„ë½, ë°˜ë³µ ì´ìŠˆ
- Pending: ê²°ë¡  ìœ ë³´, íŒë‹¨ ë¯¸ì •, ì •ë³´ ë¶€ì¡±

{examples}

[íšŒì˜ ìš”ì•½]
"""{summary}"""

[Action Item]
"""{action}"""

â†’ ìƒíƒœ:
â†’ ì´ìœ :
"""
```

---

## ğŸ” 2. LLM í˜¸ì¶œ í•¨ìˆ˜

```python
import requests

def call_llm(prompt):
    url = "http://your-llm-api.local/generate"
    payload = {
        "prompt": prompt,
        "temperature": 0.0,
        "max_tokens": 100
    }
    try:
        response = requests.post(url, json=payload)
        result = response.json().get("response", "").strip()
        return result
    except Exception as e:
        return f"ERROR: {e}"
```

---

## ğŸ“Š 3. ë°ì´í„° ì²˜ë¦¬ ë° ê²°ê³¼ ì €ì¥ (Excel)

```python
import pandas as pd
import time

df = pd.read_csv("./data/íšŒì˜ìš”ì•½.csv")
results = []

for i, row in df.iterrows():
    prompt = make_prompt(row["ë¶€ì„œ"], row["ìš”ì•½"], row["ì•¡ì…˜ ì•„ì´í…œ"])
    result = call_llm(prompt)

    if "â†’ ìƒíƒœ:" in result:
        parts = result.split("â†’ ìƒíƒœ:")[1].split("â†’ ì´ìœ :")
        status = parts[0].strip()
        reason = parts[1].strip() if len(parts) > 1 else ""
    else:
        status, reason = "Uncertain", "ì •ë³´ ë¶€ì¡± ë˜ëŠ” ë¶„ë¥˜ ì‹¤íŒ¨"

    results.append({
        "íšŒì˜ì¼": row["íšŒì˜ì¼"],
        "ë¶€ì„œ": row["ë¶€ì„œ"],
        "íŒ€": row["íŒ€"],
        "ê³¼ì œëª…": row["ê³¼ì œëª…"],
        "ìš”ì•½": row["ìš”ì•½"],
        "ì•¡ì…˜ ì•„ì´í…œ": row["ì•¡ì…˜ ì•„ì´í…œ"],
        "ì˜ˆì¸¡ ìƒíƒœ": status,
        "ì´ìœ ": reason,
        "ë¶„ë¥˜ ì• ë§¤í•¨ ì—¬ë¶€": status == "Uncertain"
    })
    time.sleep(0.5)
```

---

## ğŸ“¥ 4. ë¶€ì„œë³„ Excel ì¶œë ¥

```python
results_df = pd.DataFrame(results)
for dept in results_df["ë¶€ì„œ"].unique():
    sub_df = results_df[results_df["ë¶€ì„œ"] == dept].copy()
    sub_df["ì‹¤ì œ ìƒíƒœ (ìˆ˜ì •)"] = ""
    sub_df["ì½”ë©˜íŠ¸"] = ""

    output_path = f"./output/statusê²€í† _{dept}.xlsx"
    with pd.ExcelWriter(output_path, engine="xlsxwriter") as writer:
        sub_df.to_excel(writer, index=False, sheet_name="ê²€í† ìš”ì²­")
```

---

## âœ… ê¸°ëŒ€ ê²°ê³¼

- íšŒì˜ ìš”ì•½ ê¸°ë°˜ìœ¼ë¡œ LLMì´ ìƒíƒœ ë¶„ë¥˜ ë° ì´ìœ  ì„¤ëª…
- ë¶€ì„œë³„ë¡œ ë¶„ë¦¬ëœ Excel íŒŒì¼ë¡œ ë‹´ë‹¹ìì—ê²Œ ì „ë‹¬
- ê²€í†  ê²°ê³¼ë¥¼ ë°˜ì˜í•´ í–¥í›„ ì˜ˆì‹œ ë³´ì™„ ë° 2ì°¨ ë¶„ì„ ê°€ëŠ¥
